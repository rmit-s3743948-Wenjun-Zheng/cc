<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>AddFood</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.5/examples/dashboard/">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/toastr.min.css') }}" />

    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script type=text/javascript src="{{ url_for('static', filename='js/toastr.min.js') }}"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
  <a class="navbar-brand col-md-3 col-lg-2 mr-0 px-3" href="#">Company name</a>
  <ul class="navbar-nav px-3">
    <button type="button" class="btn btn-sm btn-outline-light" onclick="Logout()">
      <span>

      </span>
       Sign out
    </button>
  </ul>
</nav>

<div class="container-fluid">
  <div class="row">
    <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
      <div class="sidebar-sticky pt-3">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link" href="/user">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
              </span>
              User
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/email">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
              </span>
              Regist Email
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/foodlist">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
              </span>
              Food List
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/add">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus-square"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg>
              </span>
              Add Food <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/popular">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-heart"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
              </span>
              Popular Food
            </a>
          </li>
        </ul>

      </div>
    </nav>

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="display-4">Add Food</h1>
        
      </div>
      <div class="row align-items-start">
        <div class="col-6" style="margin-top: 2%;">
            <form>
                <div class="form-group">
                    <label for="password">Food Name</label>
                    <input type="text" class="form-control" id="foodname" placeholder="please input food name">
                </div>
                <div class="form-group">
                  <label for="password">Food Type</label>
                  <input type="text" class="form-control" id="foodtype" placeholder="please input food type">
                </div>
                <div class="form-group">
                  <label for="password">Total Fat</label>
                  <input type="text" class="form-control" id="fat" placeholder="please input total fat">
                </div>
                <div class="form-group">
                  <label for="password">Total Calcium</label>
                  <input type="text" class="form-control" id="calcium" placeholder="please input total calcium">
                </div>

                <div class="form-group">
                  <label for="upload">Image Upload</label>
                  <div class="input-group">
                      <input type="text" class="form-control" placeholder="choose a image" />
                      <span class="input-group-btn">
                          <label for="forexIO_file" class="form-control btn btn-info">
                              Browse</label>
                          <input id="forexIO_file" type="file" onchange="set_placeholder(this)" style="display: none" />
                      </span>
                  </div>
                </div>
                <div style="padding-top: 5px;">
                    <button type="button" class="btn btn-outline-primary" onclick="Add()">Add Food</button>
                </div>
            </form>
    </main>
  </div>
</div>
<script>
  function set_placeholder(e) {
             var filename = $(e).val();
             if (filename) {
               var idx = filename.lastIndexOf("\\");
               filename = filename.substring(idx + 1);
               $(e).parent().prev().prop("placeholder", filename);
             }
        }

  function Logout(){
        $.ajax({
          url: "/add",
          type: "POST",
          contentType: "application/json",
          success: function(checkresult){
            next(checkresult.next)
          }
        })
        
        function next(url){
          window.location.href = url
        }
  }
  
  function Add(){
               
    var formdata = new FormData()
    var name = $("#foodname").val()
    var type = $("#foodtype").val()
    var fat = $("#fat").val()
    var calcium = $("#calcium").val()
    var image = document.getElementById("forexIO_file")
    var imagefile = image.files[0]
   
    formdata.append("foodname", name)
    formdata.append("foodtype", type)
    formdata.append("fat", fat)
    formdata.append("calcium", calcium)
    formdata.append("image", imagefile)

    $.ajax({
      url: "/addfood",
      type: "POST",
      data: formdata,
      processData: false,
      contentType: false,
      cache:false,
      success: function(result){
        if(result["status"] == "No file"){
          toastr.error("Do not upload image")
        }
        else if(result["status"] == "ok"){
          toastr.info("Sumbit successfully")
        }
        else if(result["status"] == "failed"){
          toastr.error("you do not have authority to execute add food operation, only admin can do this operation")
        }
      }
    })
  }
</script>
</html>
